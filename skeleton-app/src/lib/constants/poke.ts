import type { InlineDataPart } from "@google/generative-ai";
import { urlToGenerativePart } from "$lib/utils/part";

interface PokeData {
  name: string;
}

export interface PokePrompt extends PokeData {
  imageUrl: string;
  imagePart: InlineDataPart;
  oggUrl: string;
  prompt: string;
}

export const imageUrlTemplate = (id: number) =>
  `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${id}.png`;

const imageOggTemplate = (id: number) =>
  `https://raw.githubusercontent.com/PokeAPI/cries/main/cries/pokemon/latest/${id}.ogg`;

export async function createPokePrompt(
  fetchFunction: typeof window.fetch,
  pokeDict: Record<number, PokeData>,
  promptTemplate: (name: string) => string,
): Promise<Record<number, PokePrompt>> {
  return {
    ...Object.fromEntries(
      await Promise.all(
        Object.entries(pokeDict).map(async ([id, pokeData]) => [
          id,
          {
            ...pokeData,
            imageUrl: imageUrlTemplate(Number(id)),
            imagePart: await urlToGenerativePart(fetchFunction, imageUrlTemplate(Number(id)), "image/png"),
            oggUrl: imageOggTemplate(Number(id)),
            prompt: promptTemplate(pokeData.name),
          },
        ]),
      ),
    ),
  };
}

export const pokeDict: Record<number, PokeData> = {
  1: { name: "フシギダネ" },
  2: { name: "フシギソウ" },
  3: { name: "フシギバナ" },
  4: { name: "ヒトカゲ" },
  5: { name: "リザード" },
  6: { name: "リザードン" },
  7: { name: "ゼニガメ" },
  8: { name: "カメール" },
  9: { name: "カメックス" },
  10: { name: "キャタピー" },
  11: { name: "トランセル" },
  12: { name: "バタフリー" },
  13: { name: "ビードル" },
  14: { name: "コクーン" },
  15: { name: "スピアー" },
  16: { name: "ポッポ" },
  17: { name: "ピジョン" },
  18: { name: "ピジョット" },
  19: { name: "コラッタ" },
  20: { name: "ラッタ" },
  21: { name: "オニスズメ" },
  22: { name: "オニドリル" },
  23: { name: "アーボ" },
  24: { name: "アーボック" },
  25: { name: "ピカチュウ" },
  26: { name: "ライチュウ" },
  27: { name: "サンド" },
  28: { name: "サンドパン" },
  29: { name: "ニドラン♀" },
  30: { name: "ニドリーナ" },
  31: { name: "ニドクイン" },
  32: { name: "ニドラン♂" },
  33: { name: "ニドリーノ" },
  34: { name: "ニドキング" },
  35: { name: "ピッピ" },
  36: { name: "ピクシー" },
  37: { name: "ロコン" },
  38: { name: "キュウコン" },
  39: { name: "プリン" },
  40: { name: "プクリン" },
  41: { name: "ズバット" },
  42: { name: "ゴルバット" },
  43: { name: "ナゾノクサ" },
  44: { name: "クサイハナ" },
  45: { name: "ラフレシア" },
  46: { name: "パラス" },
  47: { name: "パラセクト" },
  48: { name: "コンパン" },
  49: { name: "モルフォン" },
  50: { name: "ディグダ" },
  51: { name: "ダグトリオ" },
  52: { name: "ニャース" },
  53: { name: "ペルシアン" },
  54: { name: "コダック" },
  55: { name: "ゴルダック" },
  56: { name: "マンキー" },
  57: { name: "オコリザル" },
  58: { name: "ガーディ" },
  59: { name: "ウインディ" },
  60: { name: "ニョロモ" },
  61: { name: "ニョロゾ" },
  62: { name: "ニョロボン" },
  63: { name: "ケーシィ" },
  64: { name: "ユンゲラー" },
  65: { name: "フーディン" },
  66: { name: "ワンリキー" },
  67: { name: "ゴーリキー" },
  68: { name: "カイリキー" },
  69: { name: "マダツボミ" },
  70: { name: "ウツドン" },
  71: { name: "ウツボット" },
  72: { name: "メノクラゲ" },
  73: { name: "ドククラゲ" },
  74: { name: "イシツブテ" },
  75: { name: "ゴローン" },
  76: { name: "ゴローニャ" },
  77: { name: "ポニータ" },
  78: { name: "ギャロップ" },
  79: { name: "ヤドン" },
  80: { name: "ヤドラン" },
  81: { name: "コイル" },
  82: { name: "レアコイル" },
  83: { name: "カモネギ" },
  84: { name: "ドードー" },
  85: { name: "ドードリオ" },
  86: { name: "パウワウ" },
  87: { name: "ジュゴン" },
  88: { name: "ベトベター" },
  89: { name: "ベトベトン" },
  90: { name: "シェルダー" },
  91: { name: "パルシェン" },
  92: { name: "ゴース" },
  93: { name: "ゴースト" },
  94: { name: "ゲンガー" },
  95: { name: "イワーク" },
  96: { name: "スリープ" },
  97: { name: "スリーパー" },
  98: { name: "クラブ" },
  99: { name: "キングラー" },
  100: { name: "ビリリダマ" },
  101: { name: "マルマイン" },
  102: { name: "タマタマ" },
  103: { name: "ナッシー" },
  104: { name: "カラカラ" },
  105: { name: "ガラガラ" },
  106: { name: "サワムラー" },
  107: { name: "エビワラー" },
  108: { name: "ベロリンガ" },
  109: { name: "ドガース" },
  110: { name: "マタドガス" },
  111: { name: "サイホーン" },
  112: { name: "サイドン" },
  113: { name: "ラッキー" },
  114: { name: "モンジャラ" },
  115: { name: "ガルーラ" },
  116: { name: "タッツー" },
  117: { name: "シードラ" },
  118: { name: "トサキント" },
  119: { name: "アズマオウ" },
  120: { name: "ヒトデマン" },
  121: { name: "スターミー" },
  122: { name: "バリヤード" },
  123: { name: "ストライク" },
  124: { name: "ルージュラ" },
  125: { name: "エレブー" },
  126: { name: "ブーバー" },
  127: { name: "カイロス" },
  128: { name: "ケンタロス" },
  129: { name: "コイキング" },
  130: { name: "ギャラドス" },
  131: { name: "ラプラス" },
  132: { name: "メタモン" },
  133: { name: "イーブイ" },
  134: { name: "シャワーズ" },
  135: { name: "サンダース" },
  136: { name: "ブースター" },
  137: { name: "ポリゴン" },
  138: { name: "オムナイト" },
  139: { name: "オムスター" },
  140: { name: "カブト" },
  141: { name: "カブトプス" },
  142: { name: "プテラ" },
  143: { name: "カビゴン" },
  144: { name: "フリーザー" },
  145: { name: "サンダー" },
  146: { name: "ファイヤー" },
  147: { name: "ミニリュウ" },
  148: { name: "ハクリュー" },
  149: { name: "カイリュー" },
  150: { name: "ミュウツー" },
  151: { name: "ミュウ" },
};
